---
title: XSS Vulnerability
category: security
impact: CRITICAL
impactDescription: User session hijacking, data theft
tags: xss, injection, owasp, html
---

## XSS Vulnerability

**Impact: CRITICAL (User session hijacking, data theft)**

Cross-Site Scripting (XSS) allows attackers to inject malicious scripts into web pages viewed by other users, potentially stealing sessions, credentials, or sensitive data.

**Incorrect (direct HTML injection):**

```typescript
// React - dangerouslySetInnerHTML without sanitization
<div dangerouslySetInnerHTML={{ __html: userInput }} />

// Vue - v-html without sanitization
<div v-html="userContent"></div>

// Vanilla JS - innerHTML
element.innerHTML = userComment

// Template literals
const html = `<div>${userName}</div>`
document.body.innerHTML = html
```

**Correct (sanitized or escaped):**

```typescript
// React - use text content or sanitize
<div>{userInput}</div>  // Automatically escaped

// If HTML needed, sanitize first
import DOMPurify from 'dompurify'
<div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(userInput) }} />

// Vue - prefer text interpolation
<div>{{ userContent }}</div>

// If v-html needed, sanitize
<div v-html="sanitizedContent"></div>
// computed: sanitizedContent() { return DOMPurify.sanitize(this.userContent) }

// Vanilla JS - textContent for text
element.textContent = userComment

// Or sanitize if HTML needed
element.innerHTML = DOMPurify.sanitize(userContent)
```

**Detection:**

```bash
# Grep patterns
grep -rn "innerHTML\|dangerouslySetInnerHTML\|v-html" src/
grep -rn "\.html(\|\.append(" src/ --include="*.js" --include="*.ts"

# Tools
# - eslint-plugin-security
# - semgrep
# - Snyk Code
```

**Remediation:**
1. Use framework's default escaping (React JSX, Vue {{ }})
2. Sanitize with DOMPurify when HTML is needed
3. Implement Content Security Policy (CSP)
4. Validate and sanitize all user inputs

**References:**
- [OWASP XSS Prevention](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
- [DOMPurify](https://github.com/cure53/DOMPurify)
